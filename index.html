<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<style>
@import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css");
@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap');
@media (min-width: 768px) {main {max-width: 420px;}}
body {
	font-family: 'Ubuntu', sans-serif !important;
	font-weight: 300 !important;
}
main {
    width: 100%;
	height: 100vh;
	display: flex;
	align-items: center;
	justify-content: center;
}
section {
    width: 100%;
	height: 100v%;
	display: block;
	text-align: center;
	justify-content: center;
}

a {
    text-decoration: none!important;
    color: #000000!important;
}

</style>
</head>
<body class="bg-light">
    <main class="m-auto p-2">
    <section class="container">
        <form class="form-control shadow" name="sheet">
        <table class="table">
            <tr>
                <th class="text-center" colspan="2">
                    <h2>Finance</h2>
                </th>
            </tr>
            <tr>
                <th>
                    Date
                </th>
                <th>
                    <input class="form-control" type="date" name="Date" placeholder="Date" required>
                </th>
            </tr>
            <tr>
                <th>
                    Type
                </th>
                <td>
                    <select class="form-select" name="Type">
                      <option selected>Expenditure</option></option>
                      <option value="Income">Income</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th>Nominal</th>
                <td>
                <input class="form-control" type="number" name="Nominal" required>
                </td>
            </tr>
            <tr>
                <th>Description</th>
                <td>
                <input class="form-control" type="text" name="Description" required>
                </td>
            </tr>
            
            <tr>
                <th colspan="2">
                <button class="btn border-dark save w-100 mb-5" type="submit">Save
                </button>
                <button class="btn btn-outline-dark loading d-none w-100 mb-5" type="button" disabled>
                    <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                    <span>Loading ..</span>
                </button>
                <a href="">
                <button class="alert alert-danger error d-none w-100"type="button"><strong>Error</strong></button>
                </a>
                <a href="https://docs.google.com/spreadsheets/d/1xzL2yuO7RSl2C0-BffF8tMtenPhR6YcuILE5xjGqZuU/edit?usp=drivesdk">View the google sheets</a>
                </th>
            </tr>
        </table>
        </form>
    </section>
    </main>
 <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxZnjtuUQqWcf_fFSsSndPqoONLnWI6WHBEQkjaJBl6XqPdJETM2KLZvaxA8HiX3j9e/exec'
    const form = document.forms['sheet']
    const save = document.querySelector('.save')
    const loading = document.querySelector('.loading')
    const error = document.querySelector('.error')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })

    function showLoadingIndicator () {
      save.classList.add('d-none')
      loading.classList.remove('d-none')
    }

    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        save.classList.remove('d-none');
        loading.classList.add('d-none');
        form.reset();
      }, 1000)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        error.classList.remove('d-none');
        loading.classList.add('d-none');
      }, 100)
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>

<!---" https://script.google.com/macros/s/AKfycbxZnjtuUQqWcf_fFSsSndPqoONLnWI6WHBEQkjaJBl6XqPdJETM2KLZvaxA8HiX3j9e/exec "--->